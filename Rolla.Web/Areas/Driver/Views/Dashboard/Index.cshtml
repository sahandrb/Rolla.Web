@{
    ViewData["Title"] = "میز کار راننده";
}

<div class="container-fluid">
    <div class="row">
        <div class="col-md-3 order-md-2">
            <div class="card">
                <div class="card-body text-center">
                    <h5>وضعیت: <span id="status-indicator">آفلاین</span></h5>
                    <hr />
                    <button id="btn-toggle" class="btn btn-success w-100" onclick="toggleWork()">
                        🟢 شروع کار
                    </button>
                </div>
            </div>
        </div>
        <div class="col-md-9 order-md-1">
            <div id="map" style="height: 80vh; border-radius: 10px;"></div>
        </div>
    </div>
</div>
<!-- Modal درخواست سفر -->
<div class="modal fade" id="tripModal" tabindex="-1" data-bs-backdrop="static">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header bg-success text-white">
                <h5 class="modal-title">🔔 درخواست سفر جدید</h5>
            </div>
            <div class="modal-body text-center">
                <h2 id="modal-price" class="fw-bold"></h2>
                <p>فاصله تا شما: <span id="modal-dist">...</span></p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="rejectTrip()" data-bs-dismiss="modal">رد کردن</button>
                <button type="button" class="btn btn-success w-100" onclick="acceptTrip()">✅ قبول سفر</button>
            </div>
        </div>
    </div>
</div>
<!-- باکس چت شناور برای راننده -->
<div id="chatBox" class="card shadow" style="display:none; position:fixed; bottom:20px; left:20px; width:300px; z-index:2000;">
    <div class="card-header bg-success text-white d-flex justify-content-between">
        <span>💬 گفتگو با مسافر</span>
        <button class="btn-close btn-close-white" onclick="toggleChat()"></button>
    </div>
    <div id="chatMessages" class="card-body" style="height:200px; overflow-y:auto; font-size:14px; background-color: #f8f9fa;">
        <!-- پیام‌ها اینجا ظاهر می‌شوند -->
    </div>
    <div class="card-footer p-2">
        <div class="input-group">
            <input type="text" id="chatInput" class="form-control" placeholder="پیام به مسافر...">
            <button class="btn btn-success" onclick="sendChatMessage()">ارسال</button>
        </div>
    </div>
</div>

<!-- دکمه شناور چت -->
<button id="btn-open-chat" class="btn btn-success rounded-circle shadow-lg" style="display:none; position:fixed; bottom:20px; left:20px; width:60px; height:60px; z-index:1999;" onclick="toggleChat()">💬</button>
@section Scripts {

    <script src="~/js/core/map-base.js"></script>

    <script src="~/js/logic/driver-logic.js"></script>
}